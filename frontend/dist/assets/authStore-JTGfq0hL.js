import{c as U}from"./index-DgtH0Sqm.js";const _=t=>{let n;const e=new Set,o=(i,S)=>{const v=typeof i=="function"?i(n):i;if(!Object.is(v,n)){const h=n;n=S??(typeof v!="object"||v===null)?v:Object.assign({},n,v),e.forEach(m=>m(n,h))}},a=()=>n,u={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(e.add(i),()=>e.delete(i))},d=n=t(o,a,u);return u},j=t=>t?_(t):_,w=t=>t;function C(t,n=w){const e=U.useSyncExternalStore(t.subscribe,()=>n(t.getState()),()=>n(t.getInitialState()));return U.useDebugValue(e),e}const H=t=>{const n=j(t),e=o=>C(n,o);return Object.assign(e,n),e},E=t=>t?H(t):H;function R(t,n){let e;try{e=t()}catch{return}return{getItem:a=>{var s;const f=d=>d===null?null:JSON.parse(d,void 0),u=(s=e.getItem(a))!=null?s:null;return u instanceof Promise?u.then(f):f(u)},setItem:(a,s)=>e.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>e.removeItem(a)}}const b=t=>n=>{try{const e=t(n);return e instanceof Promise?e:{then(o){return b(o)(e)},catch(o){return this}}}catch(e){return{then(o){return this},catch(o){return b(o)(e)}}}},x=(t,n)=>(e,o,a)=>{let s={storage:R(()=>localStorage),partialize:r=>r,version:0,merge:(r,g)=>({...g,...r}),...n},f=!1;const u=new Set,d=new Set;let i=s.storage;if(!i)return t((...r)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),e(...r)},o,a);const S=()=>{const r=s.partialize({...o()});return i.setItem(s.name,{state:r,version:s.version})},v=a.setState;a.setState=(r,g)=>{v(r,g),S()};const h=t((...r)=>{e(...r),S()},o,a);a.getInitialState=()=>h;let m;const I=()=>{var r,g;if(!i)return;f=!1,u.forEach(c=>{var l;return c((l=o())!=null?l:h)});const y=((g=s.onRehydrateStorage)==null?void 0:g.call(s,(r=o())!=null?r:h))||void 0;return b(i.getItem.bind(i))(s.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==s.version){if(s.migrate){const l=s.migrate(c.state,c.version);return l instanceof Promise?l.then(p=>[!0,p]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var l;const[p,O]=c;if(m=s.merge(O,(l=o())!=null?l:h),e(m,!0),p)return S()}).then(()=>{y==null||y(m,void 0),m=o(),f=!0,d.forEach(c=>c(m))}).catch(c=>{y==null||y(void 0,c)})};return a.persist={setOptions:r=>{s={...s,...r},r.storage&&(i=r.storage)},clearStorage:()=>{i==null||i.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>f,onHydrate:r=>(u.add(r),()=>{u.delete(r)}),onFinishHydration:r=>(d.add(r),()=>{d.delete(r)})},s.skipHydration||I(),m||h},F=x,N=E(F(t=>({currentUser:null,setCurrentUser:n=>t({currentUser:n}),removeCurrentUser:()=>t({currentUser:null}),updateCurrentUser:n=>t({currentUser:n})})));export{E as c,N as u};
